%\VignetteIndexEntry{Bioconductor LaTeX Style}
%\VignettePackage{BiocStyle}
%\VignetteEngine{utils::Sweave}

\documentclass{article}
\usepackage{amsmath}

\RequirePackage{/Library/Frameworks/R.framework/Versions/3.4/Resources/library/BiocStyle/resources/tex/Bioconductor}

\AtBeginDocument{\bibliographystyle{/Library/Frameworks/R.framework/Versions/3.4/Resources/library/BiocStyle/resources/tex/unsrturl}}
\newcommand{\exitem}[3]{%
  \item \texttt{\textbackslash#1\{#2\}} #3 \csname#1\endcsname{#2}.%
}

\title{ddPCRclust --- An R package and Shiny app for automated analysis of multiplexed ddPCR data}
\author{Benedikt G. Brink, Justin Meskas, Ryan R. Brinkman}


\usepackage{Sweave}
\begin{document}
\input{ddPCRclust-concordance}

\maketitle

\tableofcontents

\section{Introduction}

Droplet digital PCR (ddPCR) is an emerging technology for quantifying DNA. By partitioning the target DNA into $\sim\,$20$\,$000 droplets, each serving as its own PCR reaction compartment, ddPCR has significantly increased sensitivity compared to other technologies for DNA quantification. However, manual analysis of the data is time consuming and algorithms for automated analysis of non-orthogonal, multiplexed ddPCR data are unavailable, presenting a major bottleneck for the advancement of ddPCR transitioning from low-throughput to high-throughput. During a ddPCR run, each genetic target is fluorescently labelled with a combination of two fluorophores (typically HEX and FAM), giving it a unique footprint in a two-dimensional space represented by the intensities per colour channel. The position of each droplet within this space reveals how many and, more importantly, which genetic targets it contains. Thus, droplets that contain the same targets cluster together. The number of positive droplets for each target determine its abundance.

ddPCRclust is an R package for automated analysis of multiplexed ddPCR data. It can automatically analyse and visualise multiplexed ddPCR experiments with up to four targets per reaction. Results are on par with manual analysis, but only take minutes to compute instead of hours. The accompanying Shiny app ddPCRvis provides easy access to the functionalities of ddPCRclust through a web-browser based GUI.

\section{Installation}
The algorithm was implemented in R and can be installed as a package. You can install this package like any other package from GitHub using devtools:

\begin{Schunk}
\begin{Sinput}
> library(devtools)
> install_github("bgbrink/ddPCRclust")
\end{Sinput}
\end{Schunk}

Or directly from Bioconductor:

\begin{Schunk}
\begin{Sinput}
> ## try http:// if https:// URLs are not supported
> source("https://bioconductor.org/biocLite.R")
> biocLite("ddPCRclust")
\end{Sinput}
\end{Schunk}

\section{Methods}
As aforementioned, data from ddPCR consist of a number of different clusters $l_1, \dots, l_k$ and their respective centroids $c_1, \dots, c_k$, which each contain droplets ($x_1, \dots, x_m$) representing one or more genetic targets $t_1, \dots, t_n$. We define four steps to successfully analyse this data:

\begin{enumerate}
\item Find all cluster centroids $c$.
\item Assign one or multiple targets $t$ to each cluster $l$ based on $c$.
\item Allocate the rain and assign a cluster label $l$ to each droplet $x$.
\item Determine the number of positive droplets for each target $t$ and calculate the CPDs.
\end{enumerate}

\section{Usage}
The main function of the package is \Rfunction{ddPCRclust}. This function runs the algorithm with one or multiple files, automatically distributing them among all CPU cores (no paralellisation on Windows). We provide eight exemplary ddPCR files along with this package. Analyse them using the following commands.

\begin{Schunk}
\begin{Sinput}
> # Run ddPCRclust
> library(ddPCRclust)
> exampleFiles <- list.files(paste0(find.package("ddPCRclust"), "/extdata"), full.names = TRUE)
> result <- ddPCRclust(files = exampleFiles[1:8], template = exampleFiles[9])